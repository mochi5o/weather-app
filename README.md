## 天気予報アプリ

### 概要

- 地域を選択すると、天気がわかるサービス
- 取得した天気情報はDBに格納して、同じ日の同一地域の天気情報はDBから取得する

### URL

http://mochi5o.com

使い方: 地図上で任意の場所を選択して現在の天気を確認します。

### 仕様

仕様（マップから天気を調べる）: 
地図上で任意の地点をクリックするとその地点の緯度経度を取得。
緯度経度情報からそのエリアの天気情報を取得して、代表地点の名称とともに天気情報を表示します。

仕様（地域名から天気を調べる）:
検索ボックスに県庁所在地などの任意の地域名を入力すると天気情報を表示します。
地名はローマ字入力が必要です。ひらがな、カタカナ、漢字などの入力には対応できませんでした。
地域名で検索可能なエリアに限りがあるため、該当する地名が存在しない場合「データが見つかりませんでした。別の地名を検索してください。」というエラーが出ます。

仕様（DBへの検索履歴のキャッシュ）: 
緯度経度、地点名と検索日時をDBへ保存します。
上記のいずれかの検索で緯度経度もしくは地点名が一致し、かつ同日に取得した情報がDBにあれば、天気情報はDBのデータから返却されます。

### DB構成

サーバー上での確認内容
```
mysql> show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| performance_schema |
| sys                |
| weather_app        |
+--------------------+
5 rows in set (0.00 sec)

mysql> use weather_app;
Database changed
mysql> show tables;
+-----------------------+
| Tables_in_weather_app |
+-----------------------+
| weathers              |
+-----------------------+
1 row in set (0.00 sec)

mysql> desc weathers;
+-------------+--------------+------+-----+-------------------+-----------------------------+
| Field       | Type         | Null | Key | Default           | Extra                       |
+-------------+--------------+------+-----+-------------------+-----------------------------+
| id          | bigint(20)   | NO   | PRI | NULL              | auto_increment              |
| name        | varchar(255) | YES  |     | NULL              |                             |
| timestamp   | varchar(255) | YES  |     | NULL              |                             |
| icon        | varchar(100) | YES  |     | NULL              |                             |
| description | mediumtext   | YES  |     | NULL              |                             |
| temperature | varchar(255) | YES  |     | NULL              |                             |
| latitude    | varchar(255) | YES  |     | NULL              |                             |
| longitude   | varchar(255) | YES  |     | NULL              |                             |
| created_at  | timestamp    | NO   |     | CURRENT_TIMESTAMP |                             |
| updated_at  | timestamp    | NO   |     | CURRENT_TIMESTAMP | on update CURRENT_TIMESTAMP |
+-------------+--------------+------+-----+-------------------+-----------------------------+
10 rows in set (0.02 sec)

mysql>
```

## 自分の中で工夫した点・チャレンジした点

- Dockerを使って環境を構築したこと
- AWSへデプロイして動作するインフラ環境を整備したこと
  - 証明書の発行、Aレコードの設定なども含めてインフラ環境を全てAWS上で整備した
- シンプルな機能ではあるが、docker-compose環境を活用してフロントとAPIをシンプルに分けて実装したこと
- 軽量なフレームワークであるExpressを使ってAPIサーバを構築したこと
- 代表地点のエリア名を使った検索と地図上でポインタを指定する検索の使いやすさを両立させたこと
  - 旅行者は旅行先の詳細なエリア名を知らないかもしれないと考えたので、マップから任意の地点の天気を調べられ、エリア名とともに確認できる仕様にした
  - 旅行者はざっくりと県名や県庁所在地など知っている情報で任意の地点の天気を検索すると考えたので、キーワードで天気を調べられる仕様にした
- API呼び出し回数を制限するためのデータ設計
  - 緯度経度の一致とエリア名の一致を条件にしてそれぞれの検索に対応した上で同一地点の天気データかどうかを判定する実装にした
